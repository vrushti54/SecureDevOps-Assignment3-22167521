
# Secure DevOps – Project 3 Final Report (ISEC6000)

**Student Name:** Vrushti Patel  
**Student ID:** 22167521  
**GitHub Repository:** [https://github.com/vrushti54/SecureDevOps-Assignment3-22167521](https://github.com/vrushti54/SecureDevOps-Assignment3-22167521)  
**Demo Recording Link:** *(To be added later – Teams / MySharePoint)*  

---

## Table of Contents
1. [Docker Setup & Validation](#1-docker-setup--validation)
2. [Compose & Portainer Deployment](#2-compose--portainer-deployment)
3. [Nextcloud Multi-Container Setup](#3-nextcloud-multi-container-setup)
4. [Clair Cluster Configuration](#4-clair-cluster-configuration)
5. [AWS CI/CD Pipeline (Placeholder)](#5-aws-cicd-pipeline-placeholder)
6. [Threat Modelling (STRIDE Framework)](#6-threat-modelling-stride-framework)
7. [Conclusion](#7-conclusion)
8. [Appendix – Command Summary](#appendix--command-summary)
9. [References](#references)

---

## 1. Docker Setup & Validation

### 1.1 Validate User Permissions

**Why:** Ensure Docker commands require `sudo` for secure container management.

**Commands Used:**
```bash
docker ps
sudo docker ps
````

**Evidence:**

![T1-1 Docker Version](./img/T1-1_docker-version.png)
*Figure 1: Docker installation verified.*

![T1-2 Non-sudo Fails](./img/T1-2_non-sudo-fails.png)
*Figure 2: Non-sudo Docker command fails.*

![T1-2 Sudo Works](./img/T1-2_sudo-works.png)
*Figure 3: Docker runs successfully with sudo privileges.*

**Outcome:**
Confirmed that Docker requires administrative privileges, maintaining least-privilege principles and secure operation.

---

## 2. Compose & Portainer Deployment

### 2.1 Apply Restart Policies

**Why:** To ensure service resilience and automatic recovery after failure.

**Commands Used:**

```bash
docker compose config
```

**Evidence:**

![T2-1 Compose Restart Policy](./img/T2-1_compose-restart-policy.png)
*Figure 4: Restart policies successfully applied.*

**Observation:**
Services restart automatically upon crash or reboot, improving system reliability.

---

### 2.2 Bring Up Containers and Verify Status

**Why:** Validate container health and Portainer dashboard visibility.

**Commands Used:**

```bash
docker compose up -d
docker ps
```

**Evidence:**

![T2-2 Compose Up](./img/T2-2_compose-up.png)
![T2-2 Docker PS](./img/T2-2_docker-ps.png)
![T2-2 Portainer Dashboard](./img/T2-2_portainer-dashboard.png)
![T2-3 Portainer Filtered](./img/T2-3_portainer-filtered.png)
*Figures 5–8: Containers active and visible in Portainer.*

**Observation:**
All services were active (“Up”) and accessible through Portainer, confirming proper orchestration.

---

## 3. Nextcloud Multi-Container Setup

### 3.1 Deploy Nextcloud Stack

**Why:** Demonstrate multi-container orchestration using Docker Compose.

**Commands Used:**

```bash
docker compose up -d
docker compose ps
```

**Evidence:**

![T3-1 Compose Inspect](./img/T3-1_compose-inspect.png)
![T3-2 Compose Up](./img/T3-2_compose-up.png)
![T3-2 Docker PS](./img/T3-2_docker-ps.png)
![T3-2 Nextcloud Dashboard](./img/T3-2_nextcloud-dashboard.png)
![T3-2 Nextcloud Setup](./img/T3-2_nextcloud-setup.png)
*Figures 9–13: Nextcloud and PostgreSQL containers successfully deployed and linked.*

**Result:**
Nextcloud web interface and database communication verified through browser UI and logs.

---

## 4. Clair Cluster Configuration

### 4.1 Run Clair Stack and Check Containers

**Why:** Set up Clair v4 with PostgreSQL backend for vulnerability scanning.

**Commands Used:**

```bash
docker compose up -d
docker compose ps
```

**Evidence:**

![T4-1 Compose PS](./img/T5-0_compose-ps.png)
*Figure 14: Clair containers running successfully.*

**Result:**
`clair` and `clair-database` containers were up and connected, forming a functional scanning backend.

---

### 4.2 Validate Clair API Endpoints and Metrics

**Why:** Ensure Clair API and metrics endpoints are healthy.

**Commands Used:**

```bash
curl -fsS http://127.0.0.1:6063/openapi/v1 | head -n 5
curl -fsS http://127.0.0.1:8089/metrics | head -n 10
curl -fsS http://127.0.0.1:6063/indexer/api/v1/index_state
```

**Evidence:**

![T4-2 Clair OpenAPI](./img/T4-2_clair_6060_curl.png)
![T4-3 Traefik Dashboard](./img/T4-3_traefik_dashboard.png)
*Figures 15–16: Successful API and Traefik dashboard validation.*

**Observation:**
API and metrics endpoints responded with valid JSON, confirming proper service initialization.

---

## 5. AWS CI/CD Pipeline (Placeholder)

**Why:** Future section for integrating Docker-based images and Clair scanning into AWS CodePipeline or CodeBuild.

**Planned Steps:**

1. Build Docker images in CodeBuild.
2. Push to Amazon ECR repository.
3. Trigger Clair scans automatically post-deployment.
4. Export results to S3 or CloudWatch for audit.

**Placeholder for Evidence:**
*(To be added once AWS screenshots and logs are generated.)*

---

## 6. Threat Modelling (STRIDE Framework)

### 6.1 STRIDE Analysis

**Why:** Identify and mitigate possible threats within the DevOps pipeline.

| **Threat**                 | **Description**                      | **Mitigation**                                   |
| -------------------------- | ------------------------------------ | ------------------------------------------------ |
| **Spoofing**               | Impersonation or fake identity usage | Use Docker Hub tokens & strong authentication    |
| **Tampering**              | Image or config alteration           | Sign images and verify SHA digests               |
| **Repudiation**            | Lack of auditability                 | Enable detailed logging and Git history          |
| **Information Disclosure** | Data leakage from containers         | Use `.env` files and Docker secrets              |
| **Denial of Service**      | Resource exhaustion                  | Set CPU/memory limits and monitor resource usage |
| **Elevation of Privilege** | Excess admin access                  | Apply least-privilege principles and RBAC        |

---

### 6.2 STRIDE Diagram

**Evidence:**

![STRIDE Diagram](./img/T6-STRIDE-diagram.png)
*Figure 17: STRIDE framework visualizing threat categories across CI/CD pipeline.*

---

## 7. Conclusion

All six tasks were completed successfully with verified evidence of deployment, scanning, and threat analysis.
The final system demonstrates strong **Secure DevOps principles**, including:

* Secure Docker orchestration and containerization
* Automated monitoring through Portainer
* End-to-end vulnerability scanning via Clair v4
* STRIDE-based threat modelling for proactive mitigation

This ensures a **robust, auditable, and secure CI/CD pipeline**.

---

## Appendix – Command Summary

### Task 1 – Docker Setup & Validation

```bash
docker version
docker ps
sudo docker ps
```

### Task 2 – Compose & Portainer Deployment

```bash
docker compose config
docker compose up -d
docker ps
```

### Task 3 – Nextcloud Multi-Container Setup

```bash
docker compose up -d
docker compose ps
```

### Task 4 – Clair Cluster Configuration

```bash
docker compose up -d
docker compose ps
curl -fsS http://127.0.0.1:6063/openapi/v1 | head -n 5
curl -fsS http://127.0.0.1:8089/metrics | head -n 10
curl -fsS http://127.0.0.1:6063/indexer/api/v1/index_state
```

### Task 5 – Vulnerability Scanning & Reporting

```bash
chmod +x clair.sh
./clair.sh scan ubuntu 22.04 ubuntu-22_04-vulns.csv
./clair.sh scan alpine 3.19
cat ubuntu-22_04-vulns.csv | head -n 10
curl -i -X DELETE "http://127.0.0.1:6063/indexer/api/v1/index_report/<digest>"
```

### Task 6 – STRIDE Threat Modelling

*(No commands – documentation and design only)*

### GitHub Repository Commands

```bash
git init
git add .
git commit -m "Secure DevOps Assignment 3 completed"
git branch -M main
git remote add origin https://github.com/vrushti54/SecureDevOps-Assignment3-22167521.git
git push -u origin main
```

---

## References

1. **Docker Documentation:** [https://docs.docker.com](https://docs.docker.com)
2. **Clair Vulnerability Scanner:** [https://quay.github.io/clair](https://quay.github.io/clair)
3. **Portainer Documentation:** [https://docs.portainer.io](https://docs.portainer.io)
4. **AWS CodePipeline & CodeBuild:** [https://docs.aws.amazon.com](https://docs.aws.amazon.com)
5. **STRIDE Framework (Microsoft):** [https://learn.microsoft.com/en-us/security/](https://learn.microsoft.com/en-us/security/)

---

**End of Report – Vrushti Patel (22167521)**


